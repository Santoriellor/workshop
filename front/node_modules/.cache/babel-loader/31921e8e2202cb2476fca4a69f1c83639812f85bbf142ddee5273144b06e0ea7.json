{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState } from \"react\";\nimport { useAxios } from \"./useAxios\";\n// Contexts\nimport { useAuth } from \"../contexts/AuthContext\";\nconst useCRUD = (apiEndpoint, parentResource = null, itemId = null) => {\n  _s();\n  const {\n    authenticatedUser\n  } = useAuth();\n  const axiosInstance = useAxios();\n  const [data, setData] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  // Construct URL dynamically\n  const baseURL = parentResource && itemId ? `${parentResource}/${itemId}/${apiEndpoint}/` : `${apiEndpoint}/`;\n\n  // Centralized error handling\n  const handleError = err => {\n    var _err$response;\n    console.error(`Error in ${apiEndpoint}:`, err.message, ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data) || \"\");\n    setError(err.message || \"An error occurred\");\n  };\n\n  // Fetch all items\n  const fetchData = async (filters = {}, sort = \"\") => {\n    if (!authenticatedUser) return;\n    if (parentResource && !itemId) {\n      setData([]); // Clear state when no itemId is selected\n      return;\n    }\n    try {\n      setLoading(true);\n\n      // Build query params\n      const params = new URLSearchParams();\n      Object.entries(filters).forEach(([key, value]) => {\n        if (value) params.append(key, value); // Only add non-empty filters\n      });\n      if (sort) params.append(\"ordering\", sort);\n      const response = await axiosInstance.get(`${baseURL}?${params.toString()}`);\n      setData(response.data);\n      return response.data;\n    } catch (err) {\n      handleError(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Create an item\n  const createItem = async itemData => {\n    if (!authenticatedUser) return;\n    try {\n      setLoading(true);\n      const response = await axiosInstance.post(`${apiEndpoint}/`, itemData);\n      setData(prev => [...prev, response.data]);\n      return response.data;\n    } catch (err) {\n      handleError(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Update an item\n  const updateItem = async (itemId, updatedFields) => {\n    if (!authenticatedUser) return;\n    try {\n      setLoading(true);\n      const response = await axiosInstance.patch(`${apiEndpoint}/${itemId}/`, updatedFields);\n      setData(prev => prev.map(item => item.id === itemId ? response.data : item));\n      return response.data;\n    } catch (err) {\n      handleError(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Delete an item\n  const deleteItem = async itemId => {\n    if (!authenticatedUser) return;\n    try {\n      setLoading(true);\n      const response = await axiosInstance.delete(`${apiEndpoint}/${itemId}/`);\n      setData(prev => prev.filter(item => item.id !== itemId));\n      return response;\n    } catch (err) {\n      handleError(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return {\n    data,\n    setData,\n    fetchData,\n    createItem,\n    updateItem,\n    deleteItem,\n    loading,\n    error\n  };\n};\n_s(useCRUD, \"P+BPLEk4hqShG03+5h7mzTqTHvI=\", false, function () {\n  return [useAuth, useAxios];\n});\nexport default useCRUD;","map":{"version":3,"names":["useState","useAxios","useAuth","useCRUD","apiEndpoint","parentResource","itemId","_s","authenticatedUser","axiosInstance","data","setData","loading","setLoading","error","setError","baseURL","handleError","err","_err$response","console","message","response","fetchData","filters","sort","params","URLSearchParams","Object","entries","forEach","key","value","append","get","toString","createItem","itemData","post","prev","updateItem","updatedFields","patch","map","item","id","deleteItem","delete","filter"],"sources":["/home/santo/Desktop/Dev/workshop/front/src/hooks/useCRUD.js"],"sourcesContent":["import { useState } from \"react\";\nimport { useAxios } from \"./useAxios\";\n// Contexts\nimport { useAuth } from \"../contexts/AuthContext\";\n\nconst useCRUD = (apiEndpoint, parentResource = null, itemId = null) => {\n  const { authenticatedUser } = useAuth();\n\n  const axiosInstance = useAxios();\n  const [data, setData] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  // Construct URL dynamically\n  const baseURL =\n    parentResource && itemId\n      ? `${parentResource}/${itemId}/${apiEndpoint}/`\n      : `${apiEndpoint}/`;\n\n  // Centralized error handling\n  const handleError = (err) => {\n    console.error(\n      `Error in ${apiEndpoint}:`,\n      err.message,\n      err.response?.data || \"\"\n    );\n    setError(err.message || \"An error occurred\");\n  };\n\n  // Fetch all items\n  const fetchData = async (filters = {}, sort = \"\") => {\n    if (!authenticatedUser) return;\n    if (parentResource && !itemId) {\n      setData([]); // Clear state when no itemId is selected\n      return;\n    }\n    try {\n      setLoading(true);\n\n      // Build query params\n      const params = new URLSearchParams();\n      Object.entries(filters).forEach(([key, value]) => {\n        if (value) params.append(key, value); // Only add non-empty filters\n      });\n      if (sort) params.append(\"ordering\", sort);\n\n      const response = await axiosInstance.get(\n        `${baseURL}?${params.toString()}`\n      );\n      setData(response.data);\n      return response.data;\n    } catch (err) {\n      handleError(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Create an item\n  const createItem = async (itemData) => {\n    if (!authenticatedUser) return;\n    try {\n      setLoading(true);\n      const response = await axiosInstance.post(`${apiEndpoint}/`, itemData);\n      setData((prev) => [...prev, response.data]);\n      return response.data;\n    } catch (err) {\n      handleError(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Update an item\n  const updateItem = async (itemId, updatedFields) => {\n    if (!authenticatedUser) return;\n    try {\n      setLoading(true);\n      const response = await axiosInstance.patch(\n        `${apiEndpoint}/${itemId}/`,\n        updatedFields\n      );\n      setData((prev) =>\n        prev.map((item) => (item.id === itemId ? response.data : item))\n      );\n      return response.data;\n    } catch (err) {\n      handleError(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Delete an item\n  const deleteItem = async (itemId) => {\n    if (!authenticatedUser) return;\n    try {\n      setLoading(true);\n      const response = await axiosInstance.delete(`${apiEndpoint}/${itemId}/`);\n      setData((prev) => prev.filter((item) => item.id !== itemId));\n      return response;\n    } catch (err) {\n      handleError(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return {\n    data,\n    setData,\n    fetchData,\n    createItem,\n    updateItem,\n    deleteItem,\n    loading,\n    error,\n  };\n};\n\nexport default useCRUD;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}