{"ast":null,"code":"var _s = $RefreshSig$();\nimport axios from \"axios\";\nimport { useAuth } from \"../contexts/AuthContext\";\nexport const useAxios = () => {\n  _s();\n  const {\n    user,\n    refreshToken,\n    logout\n  } = useAuth();\n  const axiosInstance = axios.create({\n    baseURL: \"http://localhost:8000/api/\",\n    headers: {\n      Authorization: user ? `Bearer ${localStorage.getItem(\"token\")}` : \"\"\n    }\n  });\n  axiosInstance.interceptors.response.use(response => response, async error => {\n    const originalRequest = error.config;\n    if (error.response && error.response.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n      try {\n        await refreshToken();\n        originalRequest.headers[\"Authorization\"] = `Bearer ${localStorage.getItem(\"token\")}`;\n        return axiosInstance(originalRequest);\n      } catch (refreshError) {\n        console.error(\"Token refresh failed, logging out...\");\n        logout(); // Clear session and redirect to login\n        return Promise.reject(refreshError);\n      }\n    }\n    return Promise.reject(error);\n  });\n  return axiosInstance;\n};\n_s(useAxios, \"OrJ94J/uJXjkbLokApVXFLUYClI=\", false, function () {\n  return [useAuth];\n});","map":{"version":3,"names":["axios","useAuth","useAxios","_s","user","refreshToken","logout","axiosInstance","create","baseURL","headers","Authorization","localStorage","getItem","interceptors","response","use","error","originalRequest","config","status","_retry","refreshError","console","Promise","reject"],"sources":["/home/santo/Desktop/Dev/workshop/front/src/utils/useAxios.js"],"sourcesContent":["import axios from \"axios\";\nimport { useAuth } from \"../contexts/AuthContext\";\n\nexport const useAxios = () => {\n  const { user, refreshToken, logout } = useAuth();\n\n  const axiosInstance = axios.create({\n    baseURL: \"http://localhost:8000/api/\",\n    headers: {\n      Authorization: user ? `Bearer ${localStorage.getItem(\"token\")}` : \"\",\n    },\n  });\n\n  axiosInstance.interceptors.response.use(\n    (response) => response,\n    async (error) => {\n      const originalRequest = error.config;\n\n      if (\n        error.response &&\n        error.response.status === 401 &&\n        !originalRequest._retry\n      ) {\n        originalRequest._retry = true;\n        try {\n          await refreshToken();\n          originalRequest.headers[\n            \"Authorization\"\n          ] = `Bearer ${localStorage.getItem(\"token\")}`;\n          return axiosInstance(originalRequest);\n        } catch (refreshError) {\n          console.error(\"Token refresh failed, logging out...\");\n          logout(); // Clear session and redirect to login\n          return Promise.reject(refreshError);\n        }\n      }\n      return Promise.reject(error);\n    }\n  );\n\n  return axiosInstance;\n};\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,OAAO,QAAQ,yBAAyB;AAEjD,OAAO,MAAMC,QAAQ,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC5B,MAAM;IAAEC,IAAI;IAAEC,YAAY;IAAEC;EAAO,CAAC,GAAGL,OAAO,CAAC,CAAC;EAEhD,MAAMM,aAAa,GAAGP,KAAK,CAACQ,MAAM,CAAC;IACjCC,OAAO,EAAE,4BAA4B;IACrCC,OAAO,EAAE;MACPC,aAAa,EAAEP,IAAI,GAAG,UAAUQ,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EAAE,GAAG;IACpE;EACF,CAAC,CAAC;EAEFN,aAAa,CAACO,YAAY,CAACC,QAAQ,CAACC,GAAG,CACpCD,QAAQ,IAAKA,QAAQ,EACtB,MAAOE,KAAK,IAAK;IACf,MAAMC,eAAe,GAAGD,KAAK,CAACE,MAAM;IAEpC,IACEF,KAAK,CAACF,QAAQ,IACdE,KAAK,CAACF,QAAQ,CAACK,MAAM,KAAK,GAAG,IAC7B,CAACF,eAAe,CAACG,MAAM,EACvB;MACAH,eAAe,CAACG,MAAM,GAAG,IAAI;MAC7B,IAAI;QACF,MAAMhB,YAAY,CAAC,CAAC;QACpBa,eAAe,CAACR,OAAO,CACrB,eAAe,CAChB,GAAG,UAAUE,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EAAE;QAC7C,OAAON,aAAa,CAACW,eAAe,CAAC;MACvC,CAAC,CAAC,OAAOI,YAAY,EAAE;QACrBC,OAAO,CAACN,KAAK,CAAC,sCAAsC,CAAC;QACrDX,MAAM,CAAC,CAAC,CAAC,CAAC;QACV,OAAOkB,OAAO,CAACC,MAAM,CAACH,YAAY,CAAC;MACrC;IACF;IACA,OAAOE,OAAO,CAACC,MAAM,CAACR,KAAK,CAAC;EAC9B,CACF,CAAC;EAED,OAAOV,aAAa;AACtB,CAAC;AAACJ,EAAA,CAtCWD,QAAQ;EAAA,QACoBD,OAAO;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}