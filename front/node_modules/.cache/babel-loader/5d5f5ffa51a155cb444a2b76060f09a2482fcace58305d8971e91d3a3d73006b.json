{"ast":null,"code":"var _s = $RefreshSig$();\nimport axios from \"axios\";\nimport { useAuth } from \"../contexts/AuthContext\";\nimport Toat from \"../utils/sweetalert\";\nexport const useAxios = () => {\n  _s();\n  const {\n    authenticatedUser,\n    refreshToken,\n    logout\n  } = useAuth();\n  const token = localStorage.getItem(\"token\");\n  const axiosInstance = axios.create({\n    baseURL: \"http://localhost:8000/api/\",\n    headers: token && authenticatedUser ? {\n      Authorization: `Bearer ${token}`\n    } : {}\n  });\n  axiosInstance.interceptors.response.use(response => response, async error => {\n    const originalRequest = error.config;\n    if (error.response && error.response.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n      try {\n        await refreshToken();\n        originalRequest.headers[\"Authorization\"] = `Bearer ${localStorage.getItem(\"token\")}`;\n        return axiosInstance(originalRequest);\n      } catch (refreshError) {\n        console.error(\"Token refresh failed, logging out...\");\n        logout(); // Clear session and redirect to login\n        return Promise.reject(refreshError);\n      }\n    }\n    return Promise.reject(error);\n  });\n  return axiosInstance;\n};\n_s(useAxios, \"FhtBoRGBJdg6qRYSUQ9++rZJBMw=\", false, function () {\n  return [useAuth];\n});","map":{"version":3,"names":["axios","useAuth","Toat","useAxios","_s","authenticatedUser","refreshToken","logout","token","localStorage","getItem","axiosInstance","create","baseURL","headers","Authorization","interceptors","response","use","error","originalRequest","config","status","_retry","refreshError","console","Promise","reject"],"sources":["/home/santo/Desktop/Dev/workshop/front/src/utils/useAxios.js"],"sourcesContent":["import axios from \"axios\";\nimport { useAuth } from \"../contexts/AuthContext\";\nimport Toat from \"../utils/sweetalert\";\n\nexport const useAxios = () => {\n  const { authenticatedUser, refreshToken, logout } = useAuth();\n\n  const token = localStorage.getItem(\"token\");\n  const axiosInstance = axios.create({\n    baseURL: \"http://localhost:8000/api/\",\n    headers:\n      token && authenticatedUser ? { Authorization: `Bearer ${token}` } : {},\n  });\n\n  axiosInstance.interceptors.response.use(\n    (response) => response,\n    async (error) => {\n      const originalRequest = error.config;\n\n      if (\n        error.response &&\n        error.response.status === 401 &&\n        !originalRequest._retry\n      ) {\n        originalRequest._retry = true;\n        try {\n          await refreshToken();\n          originalRequest.headers[\n            \"Authorization\"\n          ] = `Bearer ${localStorage.getItem(\"token\")}`;\n          return axiosInstance(originalRequest);\n        } catch (refreshError) {\n          console.error(\"Token refresh failed, logging out...\");\n          logout(); // Clear session and redirect to login\n          return Promise.reject(refreshError);\n        }\n      }\n      return Promise.reject(error);\n    }\n  );\n\n  return axiosInstance;\n};\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,OAAO,QAAQ,yBAAyB;AACjD,OAAOC,IAAI,MAAM,qBAAqB;AAEtC,OAAO,MAAMC,QAAQ,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC5B,MAAM;IAAEC,iBAAiB;IAAEC,YAAY;IAAEC;EAAO,CAAC,GAAGN,OAAO,CAAC,CAAC;EAE7D,MAAMO,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3C,MAAMC,aAAa,GAAGX,KAAK,CAACY,MAAM,CAAC;IACjCC,OAAO,EAAE,4BAA4B;IACrCC,OAAO,EACLN,KAAK,IAAIH,iBAAiB,GAAG;MAAEU,aAAa,EAAE,UAAUP,KAAK;IAAG,CAAC,GAAG,CAAC;EACzE,CAAC,CAAC;EAEFG,aAAa,CAACK,YAAY,CAACC,QAAQ,CAACC,GAAG,CACpCD,QAAQ,IAAKA,QAAQ,EACtB,MAAOE,KAAK,IAAK;IACf,MAAMC,eAAe,GAAGD,KAAK,CAACE,MAAM;IAEpC,IACEF,KAAK,CAACF,QAAQ,IACdE,KAAK,CAACF,QAAQ,CAACK,MAAM,KAAK,GAAG,IAC7B,CAACF,eAAe,CAACG,MAAM,EACvB;MACAH,eAAe,CAACG,MAAM,GAAG,IAAI;MAC7B,IAAI;QACF,MAAMjB,YAAY,CAAC,CAAC;QACpBc,eAAe,CAACN,OAAO,CACrB,eAAe,CAChB,GAAG,UAAUL,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EAAE;QAC7C,OAAOC,aAAa,CAACS,eAAe,CAAC;MACvC,CAAC,CAAC,OAAOI,YAAY,EAAE;QACrBC,OAAO,CAACN,KAAK,CAAC,sCAAsC,CAAC;QACrDZ,MAAM,CAAC,CAAC,CAAC,CAAC;QACV,OAAOmB,OAAO,CAACC,MAAM,CAACH,YAAY,CAAC;MACrC;IACF;IACA,OAAOE,OAAO,CAACC,MAAM,CAACR,KAAK,CAAC;EAC9B,CACF,CAAC;EAED,OAAOR,aAAa;AACtB,CAAC;AAACP,EAAA,CAtCWD,QAAQ;EAAA,QACiCF,OAAO;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}